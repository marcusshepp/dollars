{% extends "receipt/base.html" %}
{% load static %}
{% block title %}form{% endblock %}
{% block content %}
<h3 class="page-header" id="header">Purchasable Items</h3>
{{ form.errors }}
<div class="row">
  <div class="col-md-6">
    <h4 id="item_form_header">Add New Item</h4>
    <form class="formmy item_form" action="{% url 'items' %}" method="POST" enctype="multipart/form-data">{% csrf_token %}
      <p><label for="name">Name: </label><input type="text" name="name" max_length="250"/ class="pull-right"></p>
      <p><label for="company_came_from">Company: </label><input type="text" name="company_came_from" max_length="50" class="pull-right"></p>
      <p><label for="price">Price: </label><input type="number" name="price" step="0.01" class="pull-right"></p>
      <input type="button" value="Add" class="btn btn-default" onclick="send_new_item(this.form, purchase=false)">
      <input type="button" name="name" value="Add & Purchase" class="btn btn-default" onclick="send_new_item(this.form, purchase=true)">
    </form>
  </div>
  <div class="col-md-6">
      <h4>Available Items</h4>
      <div class="items">
        {% for i in items %}
        <form id="{{ i.id }}" class="item" action="{% url 'api_items' %}" onclick="itemclick(this)" method="POST">{% csrf_token %}
            <div class="pull-left" id="item_{{i.id}}">{{ i.name }}</div>
            <span class="badge pull-right">{{ i.number_of_times_purchased }}</span><br />
        </form>
        {% endfor %}
      </div>
  </div>
</div>
<span id="purchase_success"><h3>Purchases Made: All Time</h3></span>
<div class="row" id="purchased_items">
    {% for i in purchased_items %}
    <p>
        <div class="col-md-6">{{ i.item_purchased }}</div>
        <div class="col-md-6">{{ i.date_display }}</div>
    </p>
    {% endfor %}
</div>
<h3>Total</h3>
<span id="total" class="total">Calculating Total...</span>
<script type="text/javascript" src="{% static 'js/dyliams.js' %}"></script>
<script type="text/javascript" src="{% static 'js/jquery.cookie.js' %}"></script>
<script type="text/javascript">
$(document).ready(function(){
  var csrf = "{% csrf_token %}";
  $.cookie("csrfmiddlewaretoken", csrf);
});
</script>
{% endblock %}
